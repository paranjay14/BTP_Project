==> Preparing data..
Files already downloaded and verified
Files already downloaded and verified
len(trainInputDict["data"]):  50000 ,  len(valInputDict["data"]):  0 ,  len(testInputDict["data"]):  10000
nodeId:  1 , imgTensorShape :  torch.Size([50000, 3, 32, 32])
nodeId: 1 ,  parentId: 0 ,  level: 0 ,  lchildId: -1 ,  rchildId: -1 ,  isLeaf: False ,  leafClass: -1 ,  numClasses: 10
Running nodeId:  1
0 Train Loss: 179.263 | Train Acc: 37.036
1 Train Loss: 150.406 | Train Acc: 47.446
2 Train Loss: 136.408 | Train Acc: 52.476
3 Train Loss: 130.410 | Train Acc: 54.682
4 Train Loss: 125.919 | Train Acc: 56.046
5 Train Loss: 122.549 | Train Acc: 57.358
6 Train Loss: 120.088 | Train Acc: 58.054
7 Train Loss: 116.687 | Train Acc: 59.328
8 Train Loss: 114.292 | Train Acc: 60.218
9 Train Loss: 113.595 | Train Acc: 60.742
10 Train Loss: 110.282 | Train Acc: 61.760
11 Train Loss: 108.046 | Train Acc: 62.732
12 Train Loss: 106.891 | Train Acc: 63.002
13 Train Loss: 104.840 | Train Acc: 64.014
14 Train Loss: 104.132 | Train Acc: 64.068
15 Train Loss: 101.046 | Train Acc: 65.270
16 Train Loss: 101.030 | Train Acc: 64.982
17 Train Loss: 98.960 | Train Acc: 65.960
18 Train Loss: 97.806 | Train Acc: 66.360
19 Train Loss: 96.416 | Train Acc: 66.842
20 Train Loss: 92.740 | Train Acc: 68.474
21 Train Loss: 91.855 | Train Acc: 68.808
22 Train Loss: 91.633 | Train Acc: 68.672
23 Train Loss: 90.930 | Train Acc: 69.070
24 Train Loss: 90.362 | Train Acc: 69.250
25 Train Loss: 90.024 | Train Acc: 69.562
26 Train Loss: 89.637 | Train Acc: 69.568
27 Train Loss: 89.043 | Train Acc: 69.930
28 Train Loss: 88.520 | Train Acc: 69.906
29 Train Loss: 88.243 | Train Acc: 70.024
30 Train Loss: 88.064 | Train Acc: 70.064
31 Train Loss: 87.273 | Train Acc: 70.308
32 Train Loss: 87.191 | Train Acc: 70.394
33 Train Loss: 86.697 | Train Acc: 70.604
34 Train Loss: 86.204 | Train Acc: 70.686
35 Train Loss: 85.824 | Train Acc: 70.872
36 Train Loss: 85.489 | Train Acc: 71.050
37 Train Loss: 85.010 | Train Acc: 71.300
38 Train Loss: 84.958 | Train Acc: 71.092
39 Train Loss: 84.372 | Train Acc: 71.352
40 Train Loss: 82.706 | Train Acc: 72.148
41 Train Loss: 82.475 | Train Acc: 72.262
42 Train Loss: 82.316 | Train Acc: 72.382
43 Train Loss: 82.272 | Train Acc: 72.374
44 Train Loss: 82.098 | Train Acc: 72.278
45 Train Loss: 81.983 | Train Acc: 72.372
46 Train Loss: 81.707 | Train Acc: 72.618
47 Train Loss: 81.510 | Train Acc: 72.622
48 Train Loss: 81.528 | Train Acc: 72.494
49 Train Loss: 81.276 | Train Acc: 72.672
50 Train Loss: 81.134 | Train Acc: 72.762
51 Train Loss: 80.979 | Train Acc: 72.846
52 Train Loss: 80.780 | Train Acc: 72.796
53 Train Loss: 80.662 | Train Acc: 72.926
54 Train Loss: 80.470 | Train Acc: 73.058
55 Train Loss: 80.320 | Train Acc: 72.952
56 Train Loss: 80.283 | Train Acc: 72.942
57 Train Loss: 80.058 | Train Acc: 73.214
58 Train Loss: 79.899 | Train Acc: 73.172
59 Train Loss: 79.811 | Train Acc: 73.200
60 Train Loss: 78.984 | Train Acc: 73.576
61 Train Loss: 78.930 | Train Acc: 73.658
62 Train Loss: 78.925 | Train Acc: 73.620
63 Train Loss: 78.769 | Train Acc: 73.756
64 Train Loss: 78.730 | Train Acc: 73.660
65 Train Loss: 78.668 | Train Acc: 73.648
66 Train Loss: 78.658 | Train Acc: 73.684
67 Train Loss: 78.554 | Train Acc: 73.660
68 Train Loss: 78.472 | Train Acc: 73.822
69 Train Loss: 78.425 | Train Acc: 73.872
70 Train Loss: 78.401 | Train Acc: 73.864
71 Train Loss: 78.297 | Train Acc: 73.916
72 Train Loss: 78.271 | Train Acc: 73.856
73 Train Loss: 78.170 | Train Acc: 73.868
74 Train Loss: 78.191 | Train Acc: 73.844
75 Train Loss: 78.158 | Train Acc: 73.908
76 Train Loss: 78.079 | Train Acc: 73.996
77 Train Loss: 77.919 | Train Acc: 73.918
78 Train Loss: 77.891 | Train Acc: 73.988
79 Train Loss: 77.912 | Train Acc: 74.060
80 Train Loss: 77.530 | Train Acc: 74.112
81 Train Loss: 77.475 | Train Acc: 74.182
82 Train Loss: 77.479 | Train Acc: 74.138
83 Train Loss: 77.446 | Train Acc: 74.162
84 Train Loss: 77.433 | Train Acc: 74.200
85 Train Loss: 77.400 | Train Acc: 74.320
86 Train Loss: 77.374 | Train Acc: 74.210
87 Train Loss: 77.321 | Train Acc: 74.210
88 Train Loss: 77.321 | Train Acc: 74.188
89 Train Loss: 77.322 | Train Acc: 74.254
90 Train Loss: 77.282 | Train Acc: 74.256
91 Train Loss: 77.266 | Train Acc: 74.210
92 Train Loss: 77.232 | Train Acc: 74.220
93 Train Loss: 77.191 | Train Acc: 74.244
94 Train Loss: 77.168 | Train Acc: 74.314
95 Train Loss: 77.131 | Train Acc: 74.328
96 Train Loss: 77.128 | Train Acc: 74.328
97 Train Loss: 77.104 | Train Acc: 74.322
98 Train Loss: 77.104 | Train Acc: 74.256
99 Train Loss: 77.027 | Train Acc: 74.304
CNN trained successfully...
image_next_flat.shape :  torch.Size([50000, 12544])
printing expected split from k means
{9: 0, 1: 0, 8: 0, 7: 1, 4: 1, 0: 0, 3: 1, 2: 1, 5: 1, 6: 1}
Printing final_dict items...
{9: 0, 1: 0, 8: 0, 7: 1, 4: 1, 0: 0, 3: 1, 2: 1, 5: 1, 6: 1}
Image Statistics : L R :  20000 30000
expectedMlpLabels.shape :  torch.Size([50000])
0 Loss: 47.717 | Acc: 88.082
1 Loss: 39.856 | Acc: 90.070
2 Loss: 37.071 | Acc: 90.668
3 Loss: 34.797 | Acc: 91.180
4 Loss: 32.954 | Acc: 91.640
5 Loss: 31.967 | Acc: 91.986
6 Loss: 29.880 | Acc: 92.374
7 Loss: 28.408 | Acc: 92.684
8 Loss: 27.254 | Acc: 93.122
9 Loss: 25.671 | Acc: 93.378
10 Loss: 21.957 | Acc: 94.380
11 Loss: 20.699 | Acc: 94.696
12 Loss: 19.791 | Acc: 95.000
13 Loss: 18.713 | Acc: 95.234
14 Loss: 18.596 | Acc: 95.202
15 Loss: 17.114 | Acc: 95.638
16 Loss: 16.496 | Acc: 95.754
17 Loss: 16.356 | Acc: 95.888
18 Loss: 15.804 | Acc: 95.838
19 Loss: 14.758 | Acc: 96.264
20 Loss: 12.285 | Acc: 96.898
21 Loss: 11.544 | Acc: 97.114
22 Loss: 11.257 | Acc: 97.162
23 Loss: 11.163 | Acc: 97.274
24 Loss: 10.982 | Acc: 97.242
25 Loss: 10.387 | Acc: 97.440
26 Loss: 10.155 | Acc: 97.510
27 Loss: 9.428 | Acc: 97.670
28 Loss: 9.639 | Acc: 97.620
29 Loss: 9.270 | Acc: 97.714
30 Loss: 8.180 | Acc: 98.010
31 Loss: 8.212 | Acc: 97.972
32 Loss: 7.856 | Acc: 98.072
33 Loss: 7.775 | Acc: 98.066
34 Loss: 7.576 | Acc: 98.180
35 Loss: 7.371 | Acc: 98.172
36 Loss: 7.584 | Acc: 98.170
37 Loss: 7.256 | Acc: 98.180
38 Loss: 7.153 | Acc: 98.290
39 Loss: 7.234 | Acc: 98.158
40 Loss: 6.794 | Acc: 98.340
41 Loss: 6.585 | Acc: 98.414
42 Loss: 6.449 | Acc: 98.458
43 Loss: 6.658 | Acc: 98.442
44 Loss: 6.436 | Acc: 98.426
45 Loss: 6.500 | Acc: 98.444
46 Loss: 6.620 | Acc: 98.424
47 Loss: 6.379 | Acc: 98.450
48 Loss: 6.410 | Acc: 98.414
49 Loss: 6.194 | Acc: 98.526
50 Loss: 6.137 | Acc: 98.542
51 Loss: 6.248 | Acc: 98.538
52 Loss: 6.090 | Acc: 98.550
53 Loss: 6.167 | Acc: 98.576
54 Loss: 6.042 | Acc: 98.578
55 Loss: 6.052 | Acc: 98.566
56 Loss: 6.166 | Acc: 98.558
57 Loss: 5.924 | Acc: 98.566
58 Loss: 6.029 | Acc: 98.544
59 Loss: 5.988 | Acc: 98.612
MLP trained successfully...
# of Actaul Left images acc to Kmeans:  20196.0
# of Actual Right images acc to Kmeans:  29804.0
giniRightRatio:  0.8377103243719929
giniLeftRatio:  0.7451240077386199
impurityDrop:  0.7749713211936409
giniGain:  0.12502867880635915
lclasses:  [5000, 5000, 0, 0, 0, 0, 0, 0, 5000, 5000]
rclasses:  [0, 0, 5000, 5000, 5000, 5000, 5000, 5000, 0, 0]
noOfLeftClasses:  4
noOfRightClasses:  6
lTrainDict[data].shape:  torch.Size([20000, 16, 28, 28])   lTrainDict[label].shape:  torch.Size([20000])
rTrainDict[data].shape:  torch.Size([30000, 16, 28, 28])   rTrainDict[label].shape:  torch.Size([30000])
RETURNING FROM WORK...
MAX DEPTH REACHED 1
nodeId:  2 , imgTensorShape :  torch.Size([20000, 16, 28, 28])
nodeId: 2 ,  parentId: 1 ,  level: 1 ,  lchildId: -1 ,  rchildId: -1 ,  isLeaf: True ,  leafClass: -1 ,  numClasses: 4
nodeId:  3 , imgTensorShape :  torch.Size([30000, 16, 28, 28])
nodeId: 3 ,  parentId: 1 ,  level: 1 ,  lchildId: -1 ,  rchildId: -1 ,  isLeaf: True ,  leafClass: -1 ,  numClasses: 6
Running nodeId:  2
0 Train Loss: 97.349 | Train Acc: 59.530
1 Train Loss: 73.392 | Train Acc: 71.705
2 Train Loss: 64.606 | Train Acc: 75.555
3 Train Loss: 60.140 | Train Acc: 77.280
4 Train Loss: 57.198 | Train Acc: 78.640
5 Train Loss: 54.106 | Train Acc: 79.890
6 Train Loss: 51.136 | Train Acc: 81.230
7 Train Loss: 50.653 | Train Acc: 81.230
8 Train Loss: 47.324 | Train Acc: 82.470
9 Train Loss: 45.710 | Train Acc: 83.280
10 Train Loss: 46.029 | Train Acc: 82.900
11 Train Loss: 44.042 | Train Acc: 83.540
12 Train Loss: 41.966 | Train Acc: 84.450
13 Train Loss: 41.096 | Train Acc: 84.675
14 Train Loss: 39.312 | Train Acc: 85.435
15 Train Loss: 38.433 | Train Acc: 86.025
16 Train Loss: 37.643 | Train Acc: 86.205
17 Train Loss: 36.707 | Train Acc: 86.565
18 Train Loss: 35.712 | Train Acc: 87.100
19 Train Loss: 35.141 | Train Acc: 87.160
20 Train Loss: 31.229 | Train Acc: 89.030
21 Train Loss: 30.528 | Train Acc: 89.370
22 Train Loss: 30.245 | Train Acc: 89.500
23 Train Loss: 29.657 | Train Acc: 89.725
24 Train Loss: 29.237 | Train Acc: 89.840
25 Train Loss: 28.791 | Train Acc: 90.200
26 Train Loss: 28.753 | Train Acc: 90.005
27 Train Loss: 28.352 | Train Acc: 90.100
28 Train Loss: 27.863 | Train Acc: 90.200
29 Train Loss: 27.363 | Train Acc: 90.525
30 Train Loss: 27.171 | Train Acc: 90.700
31 Train Loss: 26.967 | Train Acc: 90.605
32 Train Loss: 26.779 | Train Acc: 90.700
33 Train Loss: 25.774 | Train Acc: 91.290
34 Train Loss: 25.712 | Train Acc: 91.275
35 Train Loss: 25.479 | Train Acc: 91.150
36 Train Loss: 24.774 | Train Acc: 91.515
37 Train Loss: 24.583 | Train Acc: 91.805
38 Train Loss: 24.422 | Train Acc: 91.550
39 Train Loss: 23.691 | Train Acc: 92.045
40 Train Loss: 22.500 | Train Acc: 92.795
41 Train Loss: 22.382 | Train Acc: 92.900
42 Train Loss: 22.131 | Train Acc: 92.970
43 Train Loss: 22.096 | Train Acc: 92.980
44 Train Loss: 21.746 | Train Acc: 93.065
45 Train Loss: 21.696 | Train Acc: 93.070
46 Train Loss: 21.602 | Train Acc: 93.130
47 Train Loss: 21.297 | Train Acc: 93.310
48 Train Loss: 21.347 | Train Acc: 93.260
49 Train Loss: 21.081 | Train Acc: 93.335
50 Train Loss: 21.000 | Train Acc: 93.435
51 Train Loss: 20.812 | Train Acc: 93.450
52 Train Loss: 20.622 | Train Acc: 93.750
53 Train Loss: 20.490 | Train Acc: 93.555
54 Train Loss: 20.396 | Train Acc: 93.710
55 Train Loss: 20.301 | Train Acc: 93.540
56 Train Loss: 20.079 | Train Acc: 93.880
57 Train Loss: 19.973 | Train Acc: 93.875
58 Train Loss: 19.805 | Train Acc: 93.950
59 Train Loss: 19.789 | Train Acc: 93.980
60 Train Loss: 19.140 | Train Acc: 94.340
61 Train Loss: 19.020 | Train Acc: 94.430
62 Train Loss: 18.973 | Train Acc: 94.315
63 Train Loss: 18.967 | Train Acc: 94.400
64 Train Loss: 18.880 | Train Acc: 94.495
65 Train Loss: 18.784 | Train Acc: 94.515
66 Train Loss: 18.754 | Train Acc: 94.510
67 Train Loss: 18.675 | Train Acc: 94.545
68 Train Loss: 18.679 | Train Acc: 94.435
69 Train Loss: 18.601 | Train Acc: 94.525
70 Train Loss: 18.529 | Train Acc: 94.625
71 Train Loss: 18.450 | Train Acc: 94.550
72 Train Loss: 18.427 | Train Acc: 94.730
73 Train Loss: 18.344 | Train Acc: 94.735
74 Train Loss: 18.333 | Train Acc: 94.675
75 Train Loss: 18.280 | Train Acc: 94.655
76 Train Loss: 18.231 | Train Acc: 94.780
77 Train Loss: 18.158 | Train Acc: 94.820
78 Train Loss: 18.106 | Train Acc: 94.745
79 Train Loss: 18.046 | Train Acc: 94.815
80 Train Loss: 17.760 | Train Acc: 95.025
81 Train Loss: 17.734 | Train Acc: 95.065
82 Train Loss: 17.710 | Train Acc: 95.015
83 Train Loss: 17.696 | Train Acc: 95.065
84 Train Loss: 17.686 | Train Acc: 95.015
85 Train Loss: 17.676 | Train Acc: 95.035
86 Train Loss: 17.625 | Train Acc: 95.070
87 Train Loss: 17.610 | Train Acc: 95.045
88 Train Loss: 17.611 | Train Acc: 95.035
89 Train Loss: 17.561 | Train Acc: 95.030
90 Train Loss: 17.558 | Train Acc: 95.040
91 Train Loss: 17.520 | Train Acc: 95.070
92 Train Loss: 17.490 | Train Acc: 95.160
93 Train Loss: 17.505 | Train Acc: 95.105
94 Train Loss: 17.437 | Train Acc: 95.110
95 Train Loss: 17.422 | Train Acc: 95.190
96 Train Loss: 17.404 | Train Acc: 95.115
97 Train Loss: 17.378 | Train Acc: 95.135
98 Train Loss: 17.343 | Train Acc: 95.140
99 Train Loss: 17.342 | Train Acc: 95.110
CNN trained successfully...
Running nodeId:  3
0 Train Loss: 144.080 | Train Acc: 42.650
1 Train Loss: 123.806 | Train Acc: 52.513
2 Train Loss: 115.096 | Train Acc: 56.590
3 Train Loss: 108.846 | Train Acc: 59.040
4 Train Loss: 102.851 | Train Acc: 61.273
5 Train Loss: 100.056 | Train Acc: 62.397
6 Train Loss: 98.867 | Train Acc: 62.863
7 Train Loss: 95.958 | Train Acc: 63.920
8 Train Loss: 94.230 | Train Acc: 64.680
9 Train Loss: 92.640 | Train Acc: 65.337
10 Train Loss: 90.716 | Train Acc: 66.277
11 Train Loss: 90.574 | Train Acc: 66.117
12 Train Loss: 88.724 | Train Acc: 67.163
13 Train Loss: 87.469 | Train Acc: 67.467
14 Train Loss: 87.050 | Train Acc: 67.650
15 Train Loss: 85.314 | Train Acc: 68.163
16 Train Loss: 84.215 | Train Acc: 69.060
17 Train Loss: 83.545 | Train Acc: 69.123
18 Train Loss: 82.492 | Train Acc: 69.507
19 Train Loss: 81.403 | Train Acc: 69.930
20 Train Loss: 77.798 | Train Acc: 71.590
21 Train Loss: 76.398 | Train Acc: 72.063
22 Train Loss: 75.990 | Train Acc: 72.297
23 Train Loss: 75.403 | Train Acc: 72.653
24 Train Loss: 75.104 | Train Acc: 72.843
25 Train Loss: 74.601 | Train Acc: 72.797
26 Train Loss: 74.153 | Train Acc: 73.093
27 Train Loss: 73.702 | Train Acc: 73.080
28 Train Loss: 73.531 | Train Acc: 73.103
29 Train Loss: 73.687 | Train Acc: 73.133
30 Train Loss: 72.950 | Train Acc: 73.550
31 Train Loss: 72.187 | Train Acc: 73.673
32 Train Loss: 72.142 | Train Acc: 73.813
33 Train Loss: 71.729 | Train Acc: 73.970
34 Train Loss: 71.163 | Train Acc: 74.377
35 Train Loss: 70.745 | Train Acc: 74.323
36 Train Loss: 70.342 | Train Acc: 74.597
37 Train Loss: 69.909 | Train Acc: 74.807
38 Train Loss: 69.434 | Train Acc: 74.827
39 Train Loss: 69.099 | Train Acc: 75.100
40 Train Loss: 67.350 | Train Acc: 75.943
41 Train Loss: 67.105 | Train Acc: 76.120
42 Train Loss: 66.832 | Train Acc: 76.253
43 Train Loss: 66.713 | Train Acc: 76.387
44 Train Loss: 66.570 | Train Acc: 76.377
45 Train Loss: 66.397 | Train Acc: 76.300
46 Train Loss: 66.381 | Train Acc: 76.367
47 Train Loss: 66.150 | Train Acc: 76.503
48 Train Loss: 66.118 | Train Acc: 76.393
49 Train Loss: 65.884 | Train Acc: 76.727
50 Train Loss: 65.660 | Train Acc: 76.667
51 Train Loss: 65.490 | Train Acc: 76.793
52 Train Loss: 65.301 | Train Acc: 76.827
53 Train Loss: 65.127 | Train Acc: 76.897
54 Train Loss: 65.108 | Train Acc: 76.857
55 Train Loss: 64.818 | Train Acc: 76.890
56 Train Loss: 64.622 | Train Acc: 77.043
57 Train Loss: 64.514 | Train Acc: 77.353
58 Train Loss: 64.406 | Train Acc: 77.197
59 Train Loss: 64.205 | Train Acc: 77.387
60 Train Loss: 63.353 | Train Acc: 77.730
61 Train Loss: 63.285 | Train Acc: 77.810
62 Train Loss: 63.215 | Train Acc: 77.797
63 Train Loss: 63.165 | Train Acc: 77.750
64 Train Loss: 63.011 | Train Acc: 78.023
65 Train Loss: 62.976 | Train Acc: 77.883
66 Train Loss: 62.966 | Train Acc: 77.883
67 Train Loss: 62.862 | Train Acc: 77.847
68 Train Loss: 62.777 | Train Acc: 77.970
69 Train Loss: 62.712 | Train Acc: 78.207
70 Train Loss: 62.648 | Train Acc: 78.080
71 Train Loss: 62.591 | Train Acc: 77.983
72 Train Loss: 62.559 | Train Acc: 78.047
73 Train Loss: 62.455 | Train Acc: 78.177
74 Train Loss: 62.448 | Train Acc: 78.030
75 Train Loss: 62.346 | Train Acc: 78.180
76 Train Loss: 62.273 | Train Acc: 78.187
77 Train Loss: 62.185 | Train Acc: 78.160
78 Train Loss: 62.158 | Train Acc: 78.270
79 Train Loss: 62.071 | Train Acc: 78.250
80 Train Loss: 61.725 | Train Acc: 78.347
81 Train Loss: 61.660 | Train Acc: 78.440
82 Train Loss: 61.633 | Train Acc: 78.513
83 Train Loss: 61.624 | Train Acc: 78.417
84 Train Loss: 61.571 | Train Acc: 78.520
85 Train Loss: 61.569 | Train Acc: 78.553
86 Train Loss: 61.513 | Train Acc: 78.453
87 Train Loss: 61.492 | Train Acc: 78.573
88 Train Loss: 61.475 | Train Acc: 78.447
89 Train Loss: 61.427 | Train Acc: 78.510
90 Train Loss: 61.437 | Train Acc: 78.583
91 Train Loss: 61.402 | Train Acc: 78.520
92 Train Loss: 61.365 | Train Acc: 78.527
93 Train Loss: 61.342 | Train Acc: 78.530
94 Train Loss: 61.304 | Train Acc: 78.600
95 Train Loss: 61.294 | Train Acc: 78.583
96 Train Loss: 61.292 | Train Acc: 78.597
97 Train Loss: 61.223 | Train Acc: 78.533
98 Train Loss: 61.200 | Train Acc: 78.597
99 Train Loss: 61.170 | Train Acc: 78.587
CNN trained successfully...
       1       
 ┌─────┴─────┐ 
 2           3 

       1       
 ┌─────┴─────┐ 
 2           3 

         -1        
  ┌──────┴──────┐  
  -1            -1 

         False         
   ┌───────┴───────┐   
  True            True 

